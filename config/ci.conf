# ci.conf - Configuration de la CI/CD pour git-mirror

# Systèmes d'exploitation supportés
SUPPORTED_OS=(
    "ubuntu-20.04"
    "ubuntu-22.04"
    "macos-latest"
)

# Versions de dépendances
DEP_VERSIONS=(
    "git:2.25+"
    "curl:7.68+"
    "jq:1.6+"
    "bash:4.0+"
    "parallel:20220422+"
)

# Commandes d'installation par OS
OS_INSTALL_COMMANDS=(
    "ubuntu-20.04:sudo apt-get update && sudo apt-get install -y jq parallel git curl bash"
    "ubuntu-22.04:sudo apt-get update && sudo apt-get install -y jq parallel git curl bash"
    "macos-latest:brew install jq parallel git curl bash"
)

# Commandes de test
CI_TEST_COMMANDS=(
    "shellcheck:shellcheck git-mirror.sh lib/*/*.sh config/*.sh"
    "unit:bats tests/unit/"
    "integration:bash tests/integration/test_integration.sh"
    "load:bash tests/load/test_load.sh --dry-run --repos 10 --parallel 2"
)

# Variables d'environnement pour la CI
CI_ENV=(
    "GIT_MIRROR_CI=true"
    "GIT_MIRROR_TEST_MODE=true"
    "GIT_MIRROR_TEST_DIR=/tmp/git-mirror-ci-test"
)

# Secrets GitHub
GITHUB_SECRETS=(
    "GITHUB_TOKEN"
    "INTEGRATION_TEST_TOKEN"
    "DOCKER_USERNAME"
    "DOCKER_PASSWORD"
)

# Artifacts à uploader
CI_ARTIFACTS=(
    "test-results"
    "benchmark-results"
    "coverage"
    "logs"
)
